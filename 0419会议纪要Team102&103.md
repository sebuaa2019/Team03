# 会议纪要

* DateTime：2019/04/19 7:00 p.m. GMT+8
* Place：NMB G836
* Chair：Y.X Qiao
* Panelists：Q.X Chen et al.

## 1 手册阅读交流

#### Part 1 （秦枫 祁令姿）

- map_server保存地图
- move_base 导航P37，P41
- wpb_home_apps
- 支持路径规划。

#### Part 2 （宋晓曦 刘亮）

- 使用一个类编辑运动信息
  - 方向 
  - 距离
  - 注意初始位置
- P61：可以将备选点坐标记录到waypoints.xml

#### Part 3 （周尚纯 梁夏宇）

- 人脸检测（基本上用不到）
- 抓取
  - 检测与识别是分离的
  - 支持同时检测多个物品，问题是不能距离太近
  - 根据三维点云坐标抓取（坐标，大小信息）
  - 先识别一个平面，需要将待抓取的物品放置于桌面
- 关键词是单词识别
- 开始时需要标定kineitc坐标与地面栅格重合

#### Part 4 （乔艺璇 陈麒先）

- 订制语音识别关键词（替换成科大讯飞的）
  - 作用：相对于上一部分（Part 3.19）语音识别个性化定制关键词，可以对用户的语音指令进行识别。
  - 识别原理：启动PocketSphinx脚本，将识别出的语音内容转化成字符串形式发布。
  - 订制原理：修改.corpus文件，并上传到官网（官方帮你训练模型），得到新的字典文件（.dic）和模型文件（.lm），替换掉原文件即可，官方只支持英文。
  - 使用与验证：重新launch，检查结果即可。
  - 在系统中可能的应用：扩展用户输入指令集，由于识别结果为字符串形式发布，因此可以建立指令与识别到的字符串之间的映射关系，从而达到指令预期的执行效果。
- 语音播报
  - 作用：机器人可以说话（相当于系统输出），与用户进行交互。
  - 在系统中可能的应用：改善用户体验。若开发一个导盲场景的话，此项功能就显得十分必要了。
  - 使用方法：
    - 引入头文件：ROS系统头文件和sound_play::SoundRequest头文件
    - 定义对象：定义一个sound_play::SoundRequest对象sp
    - 设置对象的参数
    - tts_pub进行发布朗读
    - sleep()控制循环周期，while(n.ok())可以循环朗读。
  - 总结：可以试图增加一个条件，当需要播报什么内容的时候，将sp.arg的值修改为需要播报的语句重新cmake并launch即可。
- 任务脚本系统
  - 核心实现：action_manager.cpp，通过结构体队列链来逻辑表示行为顺序。
  - 结构体队列链arAct(vecotr<stAct>):push_back。
  - 结构体stAct:newAct，修改其中的nAct为行为号。
  - 可编辑脚本：放置于wpb_home_apps/src/scripts 
  - 启动脚本文件：放置于wpb_home_apps/src/scripts 
- 移动抓取脚本
  - 从这一章开始往后（包括Part5）开始介绍脚本文件示例
  - 实现功能：机器人移动到指定航点，完成一套抓取动作，然后再去到另一个指定航点，将抓取到的物品交出去 。
  - 原理：可以结合任务脚本系统。
  - 设计：可以在上层封装一个用户界面：可提供若干航点位置，使用户只需选择航点位置，输入可考虑结合语音模块。实现一个代人取物功能。
  - 实现过程：手册上有详细步骤。

#### Part 5 （孙琦 林亭妤）

- 跟踪定点脚本
  - 问题：返回识别到的子串大小写问题。用户不能见关键词放在句首。
  - 实现效果：实时建图，用人来指引，也是follow me功能，记录位置（物品放置点），从标记点取物品。
- 状态机：高级调用。依赖wpb_home_apps包

## 2 设计文档计划

#### 0 需求

购物，导购机器人。

仓库分检。

药房拿药。

家用。

- 启动：等待follow me 指令，跟随用户建立地图。
- 路径规划：由管理员完成。
- **回去找找rosinit。**

#### 1 体系结构设计

##### 1.1 总体结构

> 用一系列图表（如系统体系结构图，UML类图、时序图、状态图、活动图、构件图、包图等）给出系统的总体结构，并对图中的内容进行说明。可能涉及软件体系结构、硬件体系结构、技术体系结构、支撑体系（部署和实施方案）结构等各个方面，可根据实际情况每个方面分为一小节来写。

**《软件设计PPT》P48-53**

- 感觉我们的开发刚好相反，开发手册中提供了大量可用组件及模块，我们的工作是将这些组件组合集成为一个完整的系统。

##### 1.2 关键问题解决方案

> 给出系统总体结构中所涉及的关键问题及其解决方案。针对每一项关键技术写一小节。

- 考虑到实时的障碍检测
- 语音要求高
- 考虑到地图存储偏差的校正

#### 2 接口设计

> 给出系统用户界面、系统的软硬件外部接口和内部接口的设计说明。

**参考课件《构件级设计》**

- 用户界面设计P43-51
- 接口P56

  

#### 3 详细设计

> 对于系统的每个关键模块（构件），用小节逐个给出一个模块（构件）的详细设计方案。包括该模块（构件）的类结构（类图）及其交互模型（顺序图），还可根据实际情况给出状态图（某个构件或对象的状态迁移）和活动图（某个算法的实现流程）等内容。

**参考课件《构件级设计》**

- 用户界面设计P43-51

#### 4 需求可追踪说明

> 说明SRS文档中功能同本文档总体结构部分的对应关系。可以根据本文档第2部分或者需求规格说明书文档逐项说明设计如何满足需求各项功能和非功能性需求。



#### 5 数据库设计

> 给出数据库表结构，说明表之间的关联方式。并定义数据表中的所有数据项。

**参考课件《构件级设计》**

- P39-42
- 存储坐标点数据、关键词、地图、错误日志、抓取日志、电源日志、任务日志